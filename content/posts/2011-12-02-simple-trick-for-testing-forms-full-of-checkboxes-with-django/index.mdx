---
layout: post
title: 'Simple trick for testing forms full of checkboxes with django'
date: 2011-12-02
redirect_from: 
            - /blog/simple-trick-for-testing-forms-full-of-checkboxes-with-django/swizec/3098
categories: 'Uncategorized'
author: Swizec Teller
hero: ./img/blog-wp-content-uploads-2011-12-300px-Series_of_build_lights4.jpg
---
In late 2011 I hope we can all agree that [unit testing](http://en.wikipedia.org/wiki/Unit_testing "Unit testing") is pretty \\important when creating websites or almost anything. Doesn't really matter whether you prefer a blackbox [integration testing](http://en.wikipedia.org/wiki/Integration_testing "Integration testing") approach or a strict unit testing style. What matters is that you have tests. \[caption id="" align="alignright" width="300" caption="Image via Wikipedia"][![English: A series of build lights.](./img/blog-wp-content-uploads-2011-12-300px-Series_of_build_lights4.jpg "English: A series of build lights.")](http://commons.wikipedia.org/wiki/File:Series_of_build_lights.jpg)\[/caption] But what do you do when you want to test a form with a bunch of checkboxes? You want to make sure all combinations of on/off tests are working. But with even just 6 checkboxes that's 2^6=64 test and ... well nobody in their right mind is going to write that many tests are they? Last weekend I came up with a simple solution to this problem, dare I say elegant. The approach is to make a list of checkboxes, then generate [binary numbers](http://en.wikipedia.org/wiki/Binary_numeral_system "Binary numeral system") from 0 to 2^(length of list). Then simply iterate over the generated binary numbers, pick all the checkboxes with a corresponding true bit in the number and run its test - the tests are lambda functions in a dictionary. My code was complicated slightly because I had two distinct sets of checkboxes that had to be tested separately-ish, but here's what this basically looks like in code.

```
    _columns = ['job_code', 'location_in', 'location_out', 'shift_report']

    def checkboxes(self):
        checks = []

        for i in range(2**len(self._columns):
            column_switch = bin(j)[2:].rjust(4, '0')

            checks.append([name for (yes, name) in
                           zip(column_switch, self._columns) if int(yes)])

        return checks
```

You also need to define the actual tests for all the checkboxes, deciding how thorough to be is a matter of personal taste, I like to test for the smallest possible symptom.

```
_column_checks = {
            'job_code': {True: lambda r:
                             self.assert_('Job Code' in r.content,
                                          "no code column"),
                         False: lambda r:
                             self.assert_('Job Code' not in r.content,
                                          "is code column")},
# and so on (this example has been violently snipped, likely missing a } or two
```

' in r.content, "no code column"), False: lambda r: self.assert\_('Job Code ' not in r.content, "is code column")}, # and so on And finally the whole thing becomes a simple loop

```
     for checkboxes in self.checkboxes():
          # do a bunch of posts to django to set everything up

          for check in _column_checks.keys():
                _column_checks[check][check in checkboxes['columns']](response)
```

And that's it. Simple easily modifiable code to test every possible combination of all checkboxes in a form.

###### Related articles

- [4 Steps to Remove the Share and/or Like Features](http://writingtomarketing.wordpress.com/2011/09/15/4-steps-to-remove-the-share-andor-like-features/) (writingtomarketing.wordpress.com)
- [How can I use jQuery show and hide DIVs based on checkboxes in a submitted form?](http://ask.metafilter.com/160124/How-can-I-use-jQuery-show-and-hide-DIVs-based-on-checkboxes-in-a-submitted-form) (ask.metafilter.com)
- [How do I centre this checkbox?](http://stackoverflow.com/questions/8177350/how-do-i-centre-this-checkbox) (stackoverflow.com)
- [How to use javascript to select a row of radio buttons when a checkbox is selected](http://stackoverflow.com/questions/8290408/how-to-use-javascript-to-select-a-row-of-radio-buttons-when-a-checkbox-is-select) (stackoverflow.com)

[![Enhanced by Zemanta](http://img.zemanta.com/zemified_e.png?x-id=87906043-2b53-4237-bd94-c9fd53de2ca7)](http://www.zemanta.com/ "Enhanced by Zemanta")